<?xml version="1.0"?>

<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" 
                     "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     version="1.1"
     width="460" height="310">

    <title>Vertex Shader Details</title>
    
    <script type="application/ecmascript" xlink:href="../../../../../js/svg-grid.js"></script>
    
    <script type="application/ecmascript">
        window.addEventListener("load", () => {
            //svgBkGrid.setupGrid(40);
        });
        
    </script>
    
    <defs>
        <style type="text/css"><![CDATA[
            svg {
                border: 1px solid #ccc;
            }
            
            text, tspan {
                text-anchor: middle;
                dominant-baseline: central;
                font-size: 8px;
            }
            
            text.title {
                font-family: verdana;
                font-size: 12px;
                font-weight: bold;
                fill: #369;
                stroke: none;
            }
            
            text.arrow-label {
                font-family: verdana;
                font-size: 8px;
                fill: #000;
                stroke: none;
            }
            
            text.in-rounded-box {
                font-family: verdana;
                font-size: 8px;
                fill: black;
                stroke: none;
            }
            
            text.in-state-object-box {
                font-family: verdana;
                font-size: 8px;
                fill: white;
                stroke: none;
            }
            
            g.index-number {
                font-family: arial;
                font-size: 8px;
                fill: black;
                stroke: none;
            }
            
            rect.rounded {
                fill: #eee;
                stroke: #aaa;
            }
            
            rect.state-object {
                fill: hsla(310, 55%, 38%, 0.8);
                stroke: #aaa;
            }
            
            g.redArrow path,
            g.greenArrow path,
            g.blueArrow path
            {
                stroke-width: 3px;
            }
            
            g.redArrow {
                stroke: hsla(0, 75%, 50%, 0.9);
                fill: none;
            }
            
            #red-arrow-end-marker {
                stroke: none;
                fill: hsla(0, 75%, 50%, 0.9);
            }
            
            g.greenArrow {
                stroke: hsla(120, 30%, 50%, 0.9);
                fill: none;
            }
            
            #green-arrow-end-marker {
                stroke: none;
                fill: hsla(120, 30%, 50%, 0.9);
            }
            
            g.blueArrow {
                stroke: hsla(240, 75%, 50%, 0.9);
                fill: none;
            }
            
            #blue-arrow-end-marker {
                stroke: none;
                fill: hsla(240, 75%, 50%, 0.9);
            }
        ]]></style>
        
        <path id="arrow-end-path" d="M 0 0 L 50 25 L 0 50 z" />
        
        <marker id="green-arrow-end-marker" viewBox="0 0 50 50" refX="0" refY="25" markerUnits="strokeWidth" markerWidth="3" markerHeight="3" orient="auto">
            <use xlink:href="#arrow-end-path" />
        </marker>
        
        <marker id="red-arrow-end-marker" viewBox="0 0 50 50" refX="0" refY="25" markerUnits="strokeWidth" markerWidth="3" markerHeight="3" orient="auto">
            <use xlink:href="#arrow-end-path" />
        </marker>
        
        <marker id="blue-arrow-end-marker" viewBox="0 0 50 50" refX="0" refY="25" markerUnits="strokeWidth" markerWidth="3" markerHeight="3" orient="auto">
            <use xlink:href="#arrow-end-path" />
        </marker>
        
        <g id="gl-object">
            <rect x="-20" y="-8" width="40" height="16" rx="3" ry="3" class="rounded" />
            <text x="0" y="-1" class="in-rounded-box">gl</text>
        </g>
        
        <g id="buffer-object">
            <rect x="-20" y="-8" width="40" height="16" rx="3" ry="3" class="rounded" />
            <text x="0" y="-1" class="in-rounded-box">buffer</text>
        </g>
        
        <g id="glPosition-object">
            <rect x="-30" y="-8" width="60" height="16" rx="3" ry="3" class="rounded" />
            <text x="0" y="-1" class="in-rounded-box">gl_Position</text>
        </g>
        
        <g id="vertex-shader-object">
            <rect x="-40" y="-20" width="80" height="40" rx="3" ry="3" class="state-object" />
            <text x="0" y="0" class="in-state-object-box">Vertex Shader</text>
        </g>
        
        <g id="fragment-shader-object">
            <rect x="-40" y="-20" width="80" height="40" rx="3" ry="3" class="state-object" />
            <text x="0" y="0" class="in-state-object-box">Fragment Shader</text>
        </g>
        
        <g id="program-object">
            <rect x="-40" y="-20" width="80" height="40" rx="3" ry="3" class="state-object" />
            <text x="0" y="0" class="in-state-object-box">Program</text>
        </g>
        
        <g id="arrayBuffer-object">
            <rect x="-5" y="-5" width="10" height="10" fill="red" stroke="#999" />
        </g>
        
        <path id="a-vertex-attribute-path"
              d="M 0 0 h 80 v 20 h -80 v -20
                 m 20 0 v 20
                 m 20 -20 v 20
                 m 20 -20 v 20"
              stroke="#666" />
        
        <path id="up-bracket" d="M 0,0 q 0,-8 35,-8 l 5, -8 l 5 8 Q 80,-8 80,0"
              fill="none" stroke="gray"
              transform="translate(4, -4) scale(0.9, 1)" />
        
        <g id="shader-attribute-array">
            <text x="130" y="-56"  class="title">Vertex Shader</text>
            <rect x="-20" y="-46" width="300" height="160" fill="hsla(310, 55%, 48%, 0.3)" stroke="ccc" rx="5" ry="5" />
            
            <text x="40" y="-38" class="arrow-label">vertex attrib 1</text>
            <text x="40" y="-27" class="arrow-label">[0]</text>
            
            <text x="120" y="-38" class="arrow-label">vertex attrib 2</text>
            <text x="120" y="-27" class="arrow-label">[1]</text>
            
            <text x="200" y="-38" class="arrow-label">vertex attrib 3</text>
            <text x="200" y="-27" class="arrow-label">[2]</text>
            
            <!--<text x="280" y="-28" class="arrow-label">vertex attrib 4</text>-->
            
            <use x="0" y="0" xlink:href="#a-vertex-attribute-path" fill="hsl(90, 50%, 70%)" />
            <use x="80" y="0" xlink:href="#a-vertex-attribute-path" fill="hsl(0, 0%, 75%)" />
            <use x="160" y="0" xlink:href="#a-vertex-attribute-path" fill="hsl(90, 50%, 70%)" />
            <!--<use x="240" y="0" xlink:href="#a-vertex-attribute-path" fill="hsl(120, 50%, 70%)" />-->
            
            <g class="index-number">
                <text x="10" y="28">0</text>
                <text x="30" y="28">1</text>
                <text x="50" y="28">2</text>
                <text x="70" y="28">3</text>
                <text x="90" y="28">4</text>
                <text x="110" y="28">5</text>
                <text x="130" y="28">6</text>
                <text x="150" y="28">7</text>
                <text x="170" y="28">8</text>
                <text x="190" y="28">9</text>
                <text x="210" y="28">10</text>
                <text x="230" y="28">11</text>
<!--                <text x="250" y="28">12</text>
                <text x="270" y="28">13</text>
                <text x="290" y="28">14</text>
                <text x="310" y="28">15</text>-->
            </g>
            
            <use x="0" y="0" xlink:href="#up-bracket" />
            <use x="80" y="0" xlink:href="#up-bracket" />
            <use x="160" y="0" xlink:href="#up-bracket" />
            <!--<use x="240" y="0" xlink:href="#up-bracket" />-->
            
            <text x="255" y="8">... ...</text>
            
            <g class="greenArrow">
                <path d="M 40 80 v -35" marker-end="url(#green-arrow-end-marker)" stroke-dasharray="9 3" />
            </g>
            
            <use x="40" y="100" xlink:href="#glPosition-object" />
            
            <use x="-100" y="100" xlink:href="#buffer-object" />
            
            <text x="-100" y="-10" font-family="verdana" font-size="12" fill="brown">ARRAY_BUFFER</text>
            <use x="-100" y="10" xlink:href="#arrayBuffer-object" />
            
            
            <g class="greenArrow">
                <path d="M -85 10 h 40" marker-end="url(#green-arrow-end-marker)" stroke-dasharray="9 3" />
                <path d="M -100 25 v 50" marker-end="url(#green-arrow-end-marker)" stroke-dasharray="9 3" />
            </g>
            
            <use x="130" y="180" xlink:href="#fragment-shader-object" />
            
            <g class="redArrow">
                <path d="M 60 40 v 40 h 70 v 60" marker-end="url(#red-arrow-end-marker)" />
            </g>
        </g>
    </defs>

    <g>
        <use xlink:href="#whole-grid" />
        
        <text x="230" y="14" class="title">Attribute Array in Vertex Shader</text>
        <line x1="5" y1="30" x2="455" y2="30" stroke="#999" />
        
        <use x="150" y="100" xlink:href="#shader-attribute-array" />
    </g>
</svg>